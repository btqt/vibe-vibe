---
title: "3.5.2 Mô hình cơ bản của đối thoại lặp lại"
---


![03-technique_3.5-iterative-dialogue_3.5.2-iteration-pattern.png](../../../public/images/Basic/03-technique_3.5-iterative-dialogue_3.5.2-iteration-pattern.png)
# 3.5.2 Mô hình cơ bản của đối thoại lặp lại

## Qua phần học này, bạn sẽ nắm vững

- Mô hình lặp lại ba giai đoạn: Xem hướng đi → Sửa vấn đề → Mài giũa chi tiết
- Hành động then chốt và điểm kiểm tra của mỗi vòng đối thoại
- Một ví dụ đầy đủ về đối thoại lặp lại (Danh sách việc cần làm của Tiểu Lý)
- Mẫu đối thoại lặp lại có thể sao chép dùng ngay

## Mô hình lặp lại ba giai đoạn

Đối thoại lặp lại không phải là sửa đi sửa lại một cách vô định. Lặp lại hiệu quả tuân theo một mô hình rõ ràng:

```
Vòng 1: Xem hướng đi
    ↓
  Hướng đi đúng không? Tư duy tổng thể đúng không?
    ↓
Vòng 2: Sửa vấn đề
    ↓
  Chức năng đầy đủ không? Có khiếm khuyết rõ ràng không?
    ↓
Vòng 3: Mài giũa chi tiết
    ↓
  Cấu trúc code tốt không? Có trường hợp biên không?
    ↓
  Hoàn thành
```

### Vòng 1: Xem hướng đi

**Mục tiêu**: Xác nhận AI đã hiểu ý đồ của bạn, hướng đi tổng thể chính xác.

**Hành động then chốt**:
- Đưa ra nhu cầu cốt lõi, đừng sa đà vào chi tiết
- Nói rõ với AI "Trước tiên hãy cho tôi bản thực hiện cơ bản"
- Trọng tâm xem: AI hiểu có đúng không? Hướng đi lớn có đúng không?

**Điểm kiểm tra**:
- [ ] AI có làm đúng chức năng bạn muốn không?
- [ ] Giải pháp kỹ thuật có nhất quán với dự kiến của bạn không?
- [ ] Nếu hướng đi sai, phải đính chính ngay lúc này

**Vấn đề thường gặp**: Sai hướng đi. Ví dụ bạn muốn một popup, AI lại làm cho bạn một trang mới.

### Vòng 2: Sửa vấn đề

**Mục tiêu**: Sửa chữa các vấn đề rõ ràng của vòng 1, bổ sung các tính năng bị thiếu.

**Hành động then chốt**:
- Chỉ ra vấn đề cụ thể, đừng nói "không đúng lắm"
- Liệt kê các điểm chức năng cần thêm vào
- Có thể đưa ra nhiều yêu cầu sửa đổi cùng lúc, nhưng đừng vượt quá 3-5 cái

**Điểm kiểm tra**:
- [ ] Các tính năng cốt lõi đã thực hiện chưa?
- [ ] Logic tương tác có chính xác không?
- [ ] Có bug rõ ràng nào không?

**Vấn đề thường gặp**: Thiếu chức năng hoặc sai logic. Ví dụ thiếu xác thực đầu vào, hoặc nút bấm không phản hồi.

### Vòng 3: Mài giũa chi tiết

**Mục tiêu**: Tối ưu hóa cấu trúc code, xử lý các trường hợp biên, nâng cao chất lượng.

**Hành động then chốt**:
- Chú ý đến khả năng bảo trì của code
- Kiểm tra trường hợp biên (nhập rỗng, nhập quá dài, ký tự đặc biệt)
- Tối ưu hóa đặt tên, chú thích, cấu trúc

**Điểm kiểm tra**:
- [ ] Cấu trúc code có rõ ràng không?
- [ ] Đã xử lý trường hợp biên chưa?
- [ ] Code có thể dùng cho production ngay chưa?

**Vấn đề thường gặp**: Code chạy được nhưng chưa đủ tốt. Ví dụ logic viết hết vào một hàm, hoặc không có xử lý lỗi.

## Ví dụ đầy đủ: Chức năng "Thêm nhiệm vụ" của Tiểu Lý

Hãy xem Tiểu Lý dùng mô hình ba giai đoạn như thế nào để lặp lại ra một chức năng thêm nhiệm vụ ưng ý.

### Đối thoại vòng 1: Xem hướng đi

**Prompt của Tiểu Lý:**
```
Tôi đang phát triển một ứng dụng danh sách việc cần làm, sử dụng React + TypeScript + Tailwind CSS.

Hãy giúp tôi thực hiện chức năng "Thêm nhiệm vụ":
- Một ô nhập liệu + một nút thêm
- Nhấn nút có thể thêm nhiệm vụ vào danh sách

Trước tiên hãy cho tôi bản thực hiện cơ bản, sau này sẽ hoàn thiện tiếp.
```

**Output của AI:**
```tsx
import { useState } from 'react';

interface Task {
  id: number;
  title: string;
}

export default function AddTaskForm() {
  const [tasks, setTasks] = useState<Task[]>([]);
  const [inputValue, setInputValue] = useState('');

  const handleAdd = () => {
    const newTask: Task = {
      id: Date.now(),
      title: inputValue,
    };
    setTasks([...tasks, newTask]);
    setInputValue('');
  };

  return (
    <div>
      <input
        type="text"
        value={inputValue}
        onChange={(e) => setInputValue(e.target.value)}
        className="border p-2"
      />
      <button onClick={handleAdd} className="bg-blue-500 text-white p-2 ml-2">
        Thêm
      </button>
      <ul>
        {tasks.map((task) => (
          <li key={task.id}>{task.title}</li>
        ))}
      </ul>
    </div>
  );
}
```

**Kiểm tra của Tiểu Lý**:
- ✅ Hướng đi đúng: Ô nhập liệu + Nút + Danh sách nhiệm vụ
- ✅ Stack kỹ thuật đúng: React + TypeScript + Tailwind
- ⚠️ Nhưng có vấn đề: Không có xác thực nhập liệu, có thể thêm nhiệm vụ rỗng

**Phán đoán**: Hướng đi chính xác, vào vòng 2.

### Đối thoại vòng 2: Sửa vấn đề

**Prompt của Tiểu Lý:**
```
Chức năng cơ bản được rồi, hãy thêm các cải tiến sau:

1. Hỗ trợ nhấn phím Enter để thêm nhiệm vụ (không chỉ nhấn nút)
2. Thêm xác thực nhập rỗng:
   - Khi nhập rỗng, nút hiển thị trạng thái vô hiệu hóa
   - Khi thử thêm nhiệm vụ rỗng, không thực hiện thao tác nào
3. Thêm placeholder cho ô nhập liệu: "Nhập nhiệm vụ mới..."
```

**Output của AI:**
```tsx
import { useState } from 'react';

interface Task {
  id: number;
  title: string;
}

export default function AddTaskForm() {
  const [tasks, setTasks] = useState<Task[]>([]);
  const [inputValue, setInputValue] = useState('');

  const isInputEmpty = inputValue.trim() === '';

  const handleAdd = () => {
    if (isInputEmpty) return;
    
    const newTask: Task = {
      id: Date.now(),
      title: inputValue.trim(),
    };
    setTasks([...tasks, newTask]);
    setInputValue('');
  };

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter') {
      handleAdd();
    }
  };

  return (
    <div>
      <input
        type="text"
        value={inputValue}
        onChange={(e) => setInputValue(e.target.value)}
        onKeyDown={handleKeyDown}
        placeholder="Nhập nhiệm vụ mới..."
        className="border p-2 rounded"
      />
      <button
        onClick={handleAdd}
        disabled={isInputEmpty}
        className={`p-2 ml-2 rounded ${
          isInputEmpty
            ? 'bg-gray-300 cursor-not-allowed'
            : 'bg-blue-500 text-white hover:bg-blue-600'
        }`}
      >
        Thêm
      </button>
      <ul className="mt-4">
        {tasks.map((task) => (
          <li key={task.id} className="py-1">{task.title}</li>
        ))}
      </ul>
    </div>
  );
}
```

**Kiểm tra của Tiểu Lý**:
- ✅ Thêm bằng Enter: Đã thực hiện
- ✅ Xác thực nhập rỗng: Đã thực hiện
- ✅ Placeholder: Đã thêm
- ⚠️ Vấn đề cấu trúc code: Logic xác thực và logic UI trộn lẫn với nhau

**Phán đoán**: Chức năng đầy đủ, vào vòng 3 tối ưu cấu trúc.

### Đối thoại vòng 3: Mài giũa chi tiết

**Prompt của Tiểu Lý:**
```
Chức năng đầy đủ rồi, hãy tối ưu hóa cấu trúc code:

1. Tách logic xác thực nhập liệu thành hàm độc lập validateTaskInput
2. Quản lý tên class style bằng hằng số thống nhất (tiện cho việc sửa đổi sau này)
3. Thêm chú thích cần thiết giải thích công dụng component
```

**Output cuối cùng của AI:**
```tsx
import { useState } from 'react';

// Kiểu dữ liệu nhiệm vụ
interface Task {
  id: number;
  title: string;
}

// Hằng số style
const STYLES = {
  input: 'border p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-300',
  buttonBase: 'p-2 ml-2 rounded transition-colors',
  buttonEnabled: 'bg-blue-500 text-white hover:bg-blue-600',
  buttonDisabled: 'bg-gray-300 cursor-not-allowed text-gray-500',
  taskItem: 'py-1 border-b border-gray-100',
};

// Xác thực nhập liệu nhiệm vụ
function validateTaskInput(input: string): boolean {
  return input.trim().length > 0;
}

/**
 * Component form thêm nhiệm vụ
 * Chức năng: Ô nhập liệu + Nút thêm, hỗ trợ thêm bằng Enter, bao gồm xác thực nhập rỗng
 */
export default function AddTaskForm() {
  const [tasks, setTasks] = useState<Task[]>([]);
  const [inputValue, setInputValue] = useState('');

  const isValid = validateTaskInput(inputValue);

  const handleAdd = () => {
    if (!isValid) return;
    
    const newTask: Task = {
      id: Date.now(),
      title: inputValue.trim(),
    };
    setTasks([...tasks, newTask]);
    setInputValue('');
  };

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter') {
      handleAdd();
    }
  };

  return (
    <div className="p-4">
      <div className="flex">
        <input
          type="text"
          value={inputValue}
          onChange={(e) => setInputValue(e.target.value)}
          onKeyDown={handleKeyDown}
          placeholder="Nhập nhiệm vụ mới..."
          className={STYLES.input}
        />
        <button
          onClick={handleAdd}
          disabled={!isValid}
          className={`${STYLES.buttonBase} ${
            isValid ? STYLES.buttonEnabled : STYLES.buttonDisabled
          }`}
        >
          Thêm
        </button>
      </div>
      <ul className="mt-4">
        {tasks.map((task) => (
          <li key={task.id} className={STYLES.taskItem}>
            {task.title}
          </li>
        ))}
      </ul>
    </div>
  );
}
```

**Kiểm tra của Tiểu Lý**:
- ✅ Logic xác thực độc lập: Hàm `validateTaskInput`
- ✅ Quản lý style thống nhất: Hằng số `STYLES`
- ✅ Chú thích rõ ràng: Giải thích công dụng component
- ✅ Code dễ bảo trì: Cấu trúc rõ ràng, dễ mở rộng

**Kết quả**: Ba vòng đối thoại, từ "dùng được" đến "dùng tốt".

## Danh sách hành động mỗi vòng đối thoại

| Giai đoạn | Trọng tâm của bạn | Từ khóa Prompt | Kiểm tra gì |
|-----|---------|------------|---------|
| Vòng 1 | Xem hướng đi | "Thực hiện cơ bản", "Trước tiên hãy cho tôi..." | Hướng đi đúng không? Hiểu đúng không? |
| Vòng 2 | Sửa vấn đề | "Hãy thêm...", "Chỉnh sửa..." | Chức năng đầy đủ không? Logic đúng không? |
| Vòng 3 | Mài giũa chi tiết | "Tối ưu cấu trúc", "Tách thành hàm" | Code dễ bảo trì không? Trường hợp biên? |

## Mẫu có thể sao chép: Kịch bản đối thoại lặp lại

### Mẫu vòng 1: Thiết lập hướng đi

```markdown
Tôi đang phát triển [Tên dự án], sử dụng [Stack kỹ thuật].

Hãy giúp tôi thực hiện [Tên chức năng]:
- [Nhu cầu cốt lõi 1]
- [Nhu cầu cốt lõi 2]

Trước tiên hãy cho tôi bản thực hiện cơ bản, chúng ta sẽ dần hoàn thiện sau.
```

### Mẫu vòng 2: Sửa chữa vấn đề

```markdown
Chức năng cơ bản được rồi, hãy thêm các cải tiến sau:

1. [Chức năng cần thêm/Vấn đề cần sửa]
2. [Chức năng cần thêm/Vấn đề cần sửa]
3. [Chức năng cần thêm/Vấn đề cần sửa]
```

### Mẫu vòng 3: Tối ưu chi tiết

```markdown
Chức năng đầy đủ rồi, hãy tối ưu hóa code:

1. [Yêu cầu tối ưu cấu trúc]
2. [Xử lý trường hợp biên]
3. [Yêu cầu chất lượng khác]
```

## Khi nào có thể bỏ qua một giai đoạn?

| Tình huống | Có thể bỏ qua | Nguyên nhân |
|-----|---------|------|
| Nhiệm vụ cực đơn giản | Vòng 3 | Lượng code ít, không cần tối ưu cấu trúc |
| Output vòng 1 đã rất tốt | Vòng 2 | Đi thẳng vào mài giũa chi tiết |
| Chỉ là xác minh nguyên mẫu nhanh | Vòng 3 | Sau này sẽ viết lại, không cần hoàn hảo |

## Giá trị kinh nghiệm về số lần lặp lại

| Độ phức tạp nhiệm vụ | Số vòng lặp lại điển hình | Ví dụ |
|-----------|-------------|------|
| Đơn giản (Chức năng đơn lẻ) | 1-2 vòng | Một nút bấm, một ô nhập liệu |
| Trung bình (Nhiều chức năng) | 2-3 vòng | Một biểu mẫu, một component danh sách |
| Phức tạp (Module hoàn chỉnh) | 3-5 vòng | Một trang hoàn chỉnh, một tương tác phức tạp |

Nếu vượt quá 5 vòng mà vẫn chưa đạt hiệu quả mong muốn, hãy xem xét xem có phải nhu cầu bản thân chưa đủ rõ ràng, hoặc nên bắt đầu cuộc đối thoại mới.

## Điểm cốt yếu phần này

✓ **Mô hình ba giai đoạn**: Xem hướng đi → Sửa vấn đề → Mài giũa chi tiết

✓ **Mỗi vòng có tiêu điểm**: Vòng 1 không sa đà chi tiết, Vòng 2 không sa đà cấu trúc, Vòng 3 tập trung chất lượng

✓ **Điểm kiểm tra rõ ràng**: Mỗi vòng kết thúc đều có tiêu chuẩn kiểm tra rõ ràng

✓ **Điều chỉnh linh hoạt**: Nhiệm vụ đơn giản có thể bỏ qua giai đoạn, nhiệm vụ phức tạp có thể cần nhiều vòng hơn

Phần tiếp theo, chúng ta sẽ học cách đưa ra phản hồi hiệu quả cho AI — đây là chìa khóa thành công của việc lặp lại.
