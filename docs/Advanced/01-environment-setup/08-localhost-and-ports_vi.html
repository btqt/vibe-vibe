
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>08 Localhost And Ports</title>
    <style>
        body { font-family: system-ui, -apple-system, sans-serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 20px; color: #333; }
        pre { background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto; }
        code { background: #f4f4f4; padding: 2px 5px; border-radius: 3px; font-family: monospace; }
        a { color: #007bff; text-decoration: none; }
        a:hover { text-decoration: underline; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        img { max-width: 100%; height: auto; }
    </style>
</head>
<body>
<hr />
<p>title: "1.8 Localhost và Cổng"
description: "Hiểu môi trường phát triển cục bộ, nắm vững quản lý cổng"
chapter: "Chương 1"</p>
<hr />
<h1>1.8 Localhost và Cổng</h1>
<blockquote>
<p><strong>Đọc xong phần này, bạn sẽ thu hoạch được:</strong></p>
<ul>
<li>Hiểu tác dụng của localhost và khái niệm cơ bản về địa chỉ IP</li>
<li>Nắm vững ý nghĩa của cổng (port) và các cổng thường gặp</li>
<li>Học cách khởi động/dừng server phát triển, xử lý vấn đề bị chiếm dụng cổng</li>
</ul>
</blockquote>
<p>Sau khi tạo xong dự án, bước tiếp theo là khởi động server phát triển để xem ứng dụng của bạn trên trình duyệt.</p>
<h2>Khái niệm cơ bản</h2>
<h3>Localhost (Máy chủ cục bộ)</h3>
<p><strong>localhost</strong> là "địa chỉ nội bộ" của máy tính bạn, dùng để kiểm thử phát triển tại chỗ.</p>
<table>
<thead>
<tr>
<th>Địa chỉ</th>
<th>Tác dụng</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>localhost</code></td>
<td>Tên host cục bộ, tự động phân giải thành 127.0.0.1</td>
</tr>
<tr>
<td><code>127.0.0.1</code></td>
<td>Địa chỉ IP loopback (vòng lặp) cục bộ</td>
</tr>
<tr>
<td><code>http://localhost:3000</code></td>
<td>Dịch vụ chạy trên cổng 3000 của máy cục bộ</td>
</tr>
</tbody>
</table>
<p>Hai cái này tương đương nhau:</p>
<pre><code class="language-bash">ping localhost      # Hiệu quả giống bên dưới
ping 127.0.0.1
</code></pre>
<p>::: tip localhost vs Địa chỉ công khai</p>
<table>
<thead>
<tr>
<th>Môi trường phát triển</th>
<th>Môi trường sản xuất</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>localhost:3000</code></td>
<td><code>https://example.com</code></td>
</tr>
<tr>
<td>Chỉ mình bạn truy cập được</td>
<td>Ai cũng truy cập được</td>
</tr>
<tr>
<td>Dùng để debug phát triển</td>
<td>Dùng để vận hành chính thức</td>
</tr>
</tbody>
</table>
<p>:::</p>
<h3>Cổng (Port)</h3>
<p><strong>Cổng</strong> giống như cửa của một ngôi nhà, một địa chỉ IP có thể có 65535 cổng, mỗi cổng có thể chạy một dịch vụ khác nhau.</p>
<p>Nếu ví địa chỉ IP như <strong>địa chỉ tòa nhà</strong>, thì cổng chính là <strong>số phòng</strong>:</p>
<table>
<thead>
<tr>
<th>Cổng</th>
<th>Dịch vụ</th>
<th>Ứng dụng</th>
</tr>
</thead>
<tbody>
<tr>
<td>3000</td>
<td>Next.js Development Server</td>
<td><code>http://localhost:3000</code></td>
</tr>
<tr>
<td>5173</td>
<td>Vite Development Server</td>
<td><code>http://localhost:5173</code></td>
</tr>
<tr>
<td>8000</td>
<td>Python HTTP Server</td>
<td><code>http://localhost:8000</code></td>
</tr>
</tbody>
</table>
<p><strong>Các cổng phát triển thường gặp</strong>:</p>
<table>
<thead>
<tr>
<th>Cổng</th>
<th>Mục đích</th>
</tr>
</thead>
<tbody>
<tr>
<td>3000</td>
<td>Next.js, Express</td>
</tr>
<tr>
<td>5173</td>
<td>Vite</td>
</tr>
<tr>
<td>8000/8080</td>
<td>Cổng dự phòng thông dụng</td>
</tr>
<tr>
<td>80</td>
<td>HTTP (Môi trường sản xuất, có thể lược bỏ)</td>
</tr>
<tr>
<td>443</td>
<td>HTTPS (Môi trường sản xuất, có thể lược bỏ)</td>
</tr>
</tbody>
</table>
<p><strong>Quy tắc số cổng</strong>:</p>
<ul>
<li><strong>0-1023</strong>: Cổng hệ thống, cần quyền quản trị viên</li>
<li><strong>1024-49151</strong>: Cổng đăng ký, các dịch vụ thường dùng sử dụng</li>
<li><strong>49152-65535</strong>: Cổng động, sử dụng tạm thời</li>
</ul>
<h2>Khởi động server phát triển</h2>
<pre><code class="language-bash"># Vào thư mục dự án (sửa my-app thành tên dự án của bạn)
cd my-app

# Cài đặt phụ thuộc (Lần đầu chạy)
pnpm install

# Khởi động server phát triển
pnpm dev
</code></pre>
<p>::: tip Tại sao phải cài dependency trước?</p>
<p><code>pnpm install</code> sẽ tải về tất cả các gói code (dependency) mà dự án cần, không có bước này dự án không chạy được. Giống như trước khi lắp ráp nội thất cần kiểm tra xem linh kiện đã đủ chưa.</p>
<p>:::</p>
<p>Sau khi khởi động sẽ hiện thông tin tương tự:</p>
<pre><code>▲ Next.js 16.1.4
- Local:        http://localhost:3000
- Network:      http://192.168.1.100:3000

✓ Ready in 1.2s
</code></pre>
<p>Mở trình duyệt truy cập <code>http://localhost:3000</code>.</p>
<p>::: tip Khi nào cần chạy pnpm dev?</p>
<p><strong>Mỗi khi bắt đầu làm việc</strong> đều cần chạy:</p>
<ul>
<li>Lần đầu mở dự án</li>
<li>Sửa code xong muốn xem kết quả (server sẽ tự động làm mới, không cần khởi động lại)</li>
<li>Sau khi tắt server muốn làm việc tiếp</li>
</ul>
<p>Server khởi động xong cứ để đó, cho đến khi bạn làm xong việc.</p>
<p>:::</p>
<p>::: tip Địa chỉ Network có tác dụng gì?</p>
<p>Địa chỉ Local chỉ mình bạn truy cập được. Địa chỉ Network cho phép các thiết bị khác trong cùng mạng LAN (như điện thoại) truy cập, dùng để test hiệu quả trên di động.</p>
<p>:::</p>
<h2>Dừng server phát triển</h2>
<p>Trong terminal nhấn <code>Ctrl + C</code> là có thể dừng.</p>
<table>
<thead>
<tr>
<th>Hệ thống</th>
<th>Thao tác</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows / Mac / Linux</td>
<td>Nhấn <code>Ctrl + C</code></td>
</tr>
</tbody>
</table>
<p>::: warning Server tắt xong trang web sẽ mất hiệu lực</p>
<p>Khi bạn đóng terminal hoặc nhấn <code>Ctrl+C</code> dừng server, trang <code>localhost:3000</code> sẽ không truy cập được nữa.</p>
<p><strong>Điều này là bình thường</strong>: Server phát triển chỉ cung cấp dịch vụ khi đang chạy. Lần sau làm việc chỉ cần chạy lại <code>pnpm dev</code>.</p>
<p>:::</p>
<h2>Xử lý chiếm dụng cổng</h2>
<p>Khi khởi động nếu báo lỗi cổng bị chiếm dụng:</p>
<pre><code>Error: listen EADDRINUSE: address already in use :::3000
</code></pre>
<p><strong>Nhờ AI giải quyết</strong>: Gửi thông tin báo lỗi cho AI, nó sẽ giúp bạn xử lý.</p>
<p>Bạn cũng có thể đổi cổng thủ công:</p>
<pre><code class="language-bash"># Next.js: Chỉ định cổng khởi động
pnpm dev -- -p 3001
</code></pre>
<p>::: tip Tự động xử lý xung đột cổng</p>
<p>Các công cụ hiện đại (như Next.js 14+) sẽ tự động phát hiện chiếm dụng cổng, nếu 3000 bị chiếm, sẽ tự động thử 3001, 3002...</p>
<p><strong>Nhưng nếu thấy báo lỗi EADDRINUSE</strong>, chứng tỏ tự động phát hiện thất bại, cứ để AI giúp bạn xử lý.</p>
<p>:::</p>
<p>::: tip Lệnh mà AI sử dụng</p>
<p>Nếu bạn muốn biết AI dùng lệnh gì để giải quyết, tham khảo bên dưới:</p>
<p><strong>Mac / Linux</strong>:</p>
<pre><code class="language-bash">lsof -ti:3000 | xargs kill -9
</code></pre>
<p>Một lệnh là xong: tìm tiến trình chiếm dụng cổng 3000 và diệt trực tiếp.</p>
<p><strong>Windows</strong>:</p>
<pre><code class="language-powershell">netstat -ano | findstr :3000
</code></pre>
<p>Xem PID của tiến trình chiếm cổng trước, sau đó:</p>
<pre><code class="language-powershell">taskkill /PID 12345 /F
</code></pre>
<p>Thay <code>12345</code> bằng PID thực tế.</p>
<p>:::</p>
<h2>Câu hỏi thường gặp</h2>
<h3>Q: Tại sao khởi động server xong trình duyệt tự động mở localhost?</h3>
<p>Tính năng tiện lợi của công cụ phát triển. Các công cụ như Vercel, Vite sẽ tự động phát hiện server khởi động và mở trình duyệt.</p>
<h3>Q: Sửa code xong trang web không thay đổi?</h3>
<p>Server phát triển hỗ trợ <strong>Hot Reload</strong>, lưu file xong sẽ tự động làm mới. Nếu không:</p>
<ul>
<li>Kiểm tra server có đang chạy bình thường không</li>
<li>Thử làm mới trình duyệt thủ công (F5)</li>
</ul>
<h3>Q: Có thể truy cập localhost trong mạng LAN không?</h3>
<p>Không được. <code>localhost</code> chỉ truy cập được trên máy cục bộ. Truy cập mạng LAN cần dùng IP mạng LAN của máy bạn:</p>
<pre><code class="language-bash"># Xem IP máy
ipconfig        # Windows
ifconfig        # Mac/Linux

# Truy cập mạng LAN
http://192.168.1.100:3000
</code></pre>
<h3>Q: Môi trường sản xuất cũng dùng cổng 3000 à?</h3>
<p>Được, nhưng thường không để người dùng truy cập trực tiếp cổng 3000.</p>
<p><strong>Kiến trúc điển hình của môi trường sản xuất</strong>:</p>
<pre><code class="language-mermaid">graph LR
    A[Trình duyệt người dùng] --&gt; B[https://example.com&lt;br/&gt;Cổng 80/443]
    B --&gt; C[Nginx / OpenResty&lt;br/&gt;Reverse Proxy]
    C --&gt; D[Ứng dụng của bạn&lt;br/&gt;Cổng 3000]

    style A fill:#e3f2fd
    style C fill:#fff3e0
    style D fill:#f3e5f5
</code></pre>
<p>Khi người dùng truy cập <code>https://example.com</code>, yêu cầu đến Nginx trước (lắng nghe cổng 80/443), sau đó Nginx chuyển tiếp cho ứng dụng của bạn (cổng 3000).</p>
<p><strong>Đương nhiên, cũng có thể để người dùng truy cập trực tiếp IP + Cổng</strong>:</p>
<pre><code>http://IP_Server_Của_Bạn:3000
</code></pre>
<p>Nhưng như vậy không đẹp, lại lộ số cổng. Khuyên dùng Nginx làm Reverse Proxy (đảo ngược), người dùng chỉ cần nhớ tên miền.</p>
<h2>Triết lý cốt lõi</h2>
<p><strong>Localhost là nền tảng của phát triển nội bộ</strong>.</p>
<ul>
<li>✅ localhost = 127.0.0.1, đều trỏ về máy tính cục bộ</li>
<li>✅ Cổng phân biệt dịch vụ, cùng một máy có thể chạy nhiều dịch vụ</li>
<li>✅ Phát triển dùng localhost, sản xuất dùng tên miền</li>
<li>✅ Một cổng cùng lúc chỉ có thể có một tiến trình</li>
<li>✅ <code>Ctrl + C</code> dừng server</li>
</ul>
<h2>Nội dung liên quan</h2>
<ul>
<li>Xem chi tiết: <a href="./04-terminal-basics_vi.html">1.4 Nhập môn Terminal</a></li>
<li>Xem chi tiết: <a href="./07-creating-project_vi.html">1.7 Tạo dự án</a></li>
<li>Trước đó: <a href="./03-browser-server_vi.html">1.3 Cơ bản về Trình duyệt và Server</a></li>
</ul>
</body>
</html>
